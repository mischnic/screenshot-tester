os:
  - linux
  - osx
dist: trusty
language: node_js
node_js:
  - '10'
  - '9'
sudo: required
addons:
  apt:
    packages:
    - libgtk-3-dev
    - xvfb

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update         ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew upgrade python ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then pip3 install click pyobjc-framework-Quartz; fi
install:
  - yarn install
  - cd example && yarn install

before_script:
  - export DISPLAY=:99.0
  - if [ "${TRAVIS_OS_NAME}" = "linux" ]; then sh -e /etc/init.d/xvfb start; fi
  - if [ "${TRAVIS_OS_NAME}" = "osx" ]; then ( sudo Xvfb :99 -ac -screen 0 1024x768x8; echo ok ) & fi
  - sleep 3
script:
  - node index.js
after_script:
  - cd snapshots && npx now --public --token $NOW_TOKEN

env:
  global:
    secure: sOggn/FnLrem/xhMunssA0FltZJBX+YszAowDWe6J+mZK1xhbpvYjt3GREJiBwa0wejhthbUXLbbuSfD3RedBOmjFJUAdd62s/hl80ijt04SjWwATnOH+BhBhX9a/+YpOIluuNOMFfkgeTlDwSilp/ed+NDveoxXFETSHXCJq17+Lc0S5lDxJ7DHb8VTGyJoJ5W1AOWaNE9ojgT40R1y/6OCYlVFSFCNIRKgRh8n/Y17vnSoLIVLMeoHoPi/9TZUAzoXtdAkKRZSYAgzHGecjEb2eDuAsQF4MhxRaK/40GGqSPpSDoE9Bu3ClJJiCCofsRpjUscN3FveWgoJsTkilo3WnsBFv9eii9pzbeF8yKK01fjvFPlRK10pSe/DWomKvs8dQ6vhakuSppENBMl+ljR75s4EcQ5p2zj497+u7k9SLs1Z6QsjaGmHHKq0YxNZGXb8t9McpRfhNWabPk/E6P2rAGSOnY9y1NhxMwnvvqOJvLdPiit1F86+FGY8OCUAUEp8AZPKsD7FYSRRuBb4dZiGA/kPXAOmkyu9rMiadD6VLF2HMXpAeofuo0VNeBJ3o80GNWGthX0KJqGCjv8yvg3vQHTwbe+QcfPM0yzKyNTz/PUPEAFIe5X80uOLVSp3GI4ipdiJi6W6KMiHf02sniM/0pa36ogIxTMs/KHgs5o=
